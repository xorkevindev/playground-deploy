(self.webpackChunk=self.webpackChunk||[]).push([[928],{519:(e,t,r)=>{r.r(t),r.d(t,{default:()=>O});var n=r(424),s=r(724);const i=r.p+"static/wasm/jsonnet.engine.568455db6de7baee.wasm";var a=r(339),o=r(338);const l={button:"pkBVbp3Ygl_QZqv0","padded-small":"NZYOzjasZEy5sEGC",default:"CK5Yoodz1KncF_1H",subtle:"BIHZPzz3M45iRQOJ",primary:"yBO8SXTmTuf8luJR","button-group":"VYyNJIIwitjQDRnb",gap:"Q44AmYcqBs7R03Yt"};var f;!function(e){e.Default="default",e.Primary="primary",e.Subtle="subtle"}(f||(f={}));const d=(0,s.forwardRef)((({variant:e=f.Default,paddedSmall:t,className:r,children:s,...i},a)=>{const d=(0,o.xW)((0,o.Ty)(l,"button",e,{"padded-small":t}),r);return(0,n.jsx)("button",{ref:a,...i,className:d,children:s})})),u=(0,s.forwardRef)((({gap:e,className:t,children:r,...s},i)=>{const a=(0,o.xW)((0,o.Ty)(l,"button-group",{gap:e}),t);return(0,n.jsx)("div",{ref:i,...s,className:a,children:r})}));var c=r(74),h=r(359),_=r(7);const p=/\+|\/|=/g,m=/-|_/g,g=(e,t,r)=>{const n=new ArrayBuffer(Math.min(t,r));return new Uint8Array(n).set(new Uint8Array(e)),n},w=async e=>{const t=new TextEncoder,r=await crypto.subtle.digest("SHA-256",t.encode(e));return Array.from(new Uint8Array(r)).map((e=>e.toString(16).padStart(2,"0"))).join("")},b=58;class y{static read_bytes(e,t){const r=new y;return r.buf=e.getUint32(t,!0),r.buf_len=e.getUint32(t+4,!0),r}static read_bytes_array(e,t,r){const n=[];for(let s=0;s<r;s++)n.push(y.read_bytes(e,t+8*s));return n}}class x{static read_bytes(e,t){const r=new x;return r.buf=e.getUint32(t,!0),r.buf_len=e.getUint32(t+4,!0),r}static read_bytes_array(e,t,r){const n=[];for(let s=0;s<r;s++)n.push(x.read_bytes(e,t+8*s));return n}}class U{write_bytes(e,t){e.setUint8(t,this.fs_filetype),e.setUint16(t+2,this.fs_flags,!0),e.setBigUint64(t+8,this.fs_rights_base,!0),e.setBigUint64(t+16,this.fs_rights_inherited,!0)}constructor(e,t){this.fs_rights_base=0n,this.fs_rights_inherited=0n,this.fs_filetype=e,this.fs_flags=t}}class j{write_bytes(e,t){e.setBigUint64(t,this.dev,!0),e.setBigUint64(t+8,this.ino,!0),e.setUint8(t+16,this.filetype),e.setBigUint64(t+24,this.nlink,!0),e.setBigUint64(t+32,this.size,!0),e.setBigUint64(t+38,this.atim,!0),e.setBigUint64(t+46,this.mtim,!0),e.setBigUint64(t+52,this.ctim,!0)}constructor(e,t){this.dev=0n,this.ino=0n,this.nlink=0n,this.atim=0n,this.mtim=0n,this.ctim=0n,this.filetype=e,this.size=t}}const k=new class{enable(e){this.log=function(e,t){return e?console.log.bind(console,"%c%s","color: #265BA0",t):()=>{}}(void 0===e||e,this.prefix)}get enabled(){return this.isEnabled}constructor(e){this.isEnabled=e,this.prefix="wasi:",this.enable(e)}}(!1);class v extends Error{constructor(e){super("exit with exit code "+e),this.code=e}}let A=class{start(e){this.inst=e;try{return e.exports._start(),0}catch(e){if(e instanceof v)return e.code;throw e}}initialize(e){this.inst=e,e.exports._initialize&&e.exports._initialize()}constructor(e,t,r,n={}){this.args=[],this.env=[],this.fds=[],k.enable(n.debug),this.args=e,this.env=t,this.fds=r;const s=this;this.wasiImport={args_sizes_get(e,t){const r=new DataView(s.inst.exports.memory.buffer);r.setUint32(e,s.args.length,!0);let n=0;for(const e of s.args)n+=e.length+1;return r.setUint32(t,n,!0),k.log(r.getUint32(e,!0),r.getUint32(t,!0)),0},args_get(e,t){const r=new DataView(s.inst.exports.memory.buffer),n=new Uint8Array(s.inst.exports.memory.buffer),i=t;for(let i=0;i<s.args.length;i++){r.setUint32(e,t,!0),e+=4;const a=(new TextEncoder).encode(s.args[i]);n.set(a,t),r.setUint8(t+a.length,0),t+=a.length+1}return k.enabled&&k.log(new TextDecoder("utf-8").decode(n.slice(i,t))),0},environ_sizes_get(e,t){const r=new DataView(s.inst.exports.memory.buffer);r.setUint32(e,s.env.length,!0);let n=0;for(const e of s.env)n+=e.length+1;return r.setUint32(t,n,!0),k.log(r.getUint32(e,!0),r.getUint32(t,!0)),0},environ_get(e,t){const r=new DataView(s.inst.exports.memory.buffer),n=new Uint8Array(s.inst.exports.memory.buffer),i=t;for(let i=0;i<s.env.length;i++){r.setUint32(e,t,!0),e+=4;const a=(new TextEncoder).encode(s.env[i]);n.set(a,t),r.setUint8(t+a.length,0),t+=a.length+1}return k.enabled&&k.log(new TextDecoder("utf-8").decode(n.slice(i,t))),0},clock_res_get(e,t){let r;switch(e){case 1:r=5000n;break;case 0:r=1000000n;break;default:return 52}return new DataView(s.inst.exports.memory.buffer).setBigUint64(t,r,!0),0},clock_time_get(e,t,r){const n=new DataView(s.inst.exports.memory.buffer);if(0===e)n.setBigUint64(r,1000000n*BigInt((new Date).getTime()),!0);else if(1==e){let e;try{e=BigInt(Math.round(1e6*performance.now()))}catch(t){e=0n}n.setBigUint64(r,e,!0)}else n.setBigUint64(r,0n,!0);return 0},fd_advise:(e,t,r,n)=>null!=s.fds[e]?0:8,fd_allocate:(e,t,r)=>null!=s.fds[e]?s.fds[e].fd_allocate(t,r):8,fd_close(e){if(null!=s.fds[e]){const t=s.fds[e].fd_close();return s.fds[e]=void 0,t}return 8},fd_datasync:e=>null!=s.fds[e]?s.fds[e].fd_sync():8,fd_fdstat_get(e,t){if(null!=s.fds[e]){const{ret:r,fdstat:n}=s.fds[e].fd_fdstat_get();return null!=n&&n.write_bytes(new DataView(s.inst.exports.memory.buffer),t),r}return 8},fd_fdstat_set_flags:(e,t)=>null!=s.fds[e]?s.fds[e].fd_fdstat_set_flags(t):8,fd_fdstat_set_rights:(e,t,r)=>null!=s.fds[e]?s.fds[e].fd_fdstat_set_rights(t,r):8,fd_filestat_get(e,t){if(null!=s.fds[e]){const{ret:r,filestat:n}=s.fds[e].fd_filestat_get();return null!=n&&n.write_bytes(new DataView(s.inst.exports.memory.buffer),t),r}return 8},fd_filestat_set_size:(e,t)=>null!=s.fds[e]?s.fds[e].fd_filestat_set_size(t):8,fd_filestat_set_times:(e,t,r,n)=>null!=s.fds[e]?s.fds[e].fd_filestat_set_times(t,r,n):8,fd_pread(e,t,r,n,i){const a=new DataView(s.inst.exports.memory.buffer),o=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const l=y.read_bytes_array(a,t,r);let f=0;for(const t of l){const{ret:r,data:l}=s.fds[e].fd_pread(t.buf_len,n);if(0!=r)return a.setUint32(i,f,!0),r;if(o.set(l,t.buf),f+=l.length,n+=BigInt(l.length),l.length!=t.buf_len)break}return a.setUint32(i,f,!0),0}return 8},fd_prestat_get(e,t){const r=new DataView(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const{ret:n,prestat:i}=s.fds[e].fd_prestat_get();return null!=i&&i.write_bytes(r,t),n}return 8},fd_prestat_dir_name(e,t,r){if(null!=s.fds[e]){const{ret:n,prestat:i}=s.fds[e].fd_prestat_get();if(null==i)return n;const a=i.inner.pr_name;return new Uint8Array(s.inst.exports.memory.buffer).set(a.slice(0,r),t),a.byteLength>r?37:0}return 8},fd_pwrite(e,t,r,n,i){const a=new DataView(s.inst.exports.memory.buffer),o=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const l=x.read_bytes_array(a,t,r);let f=0;for(const t of l){const r=o.slice(t.buf,t.buf+t.buf_len),{ret:l,nwritten:d}=s.fds[e].fd_pwrite(r,n);if(0!=l)return a.setUint32(i,f,!0),l;if(f+=d,n+=BigInt(d),d!=r.byteLength)break}return a.setUint32(i,f,!0),0}return 8},fd_read(e,t,r,n){const i=new DataView(s.inst.exports.memory.buffer),a=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const o=y.read_bytes_array(i,t,r);let l=0;for(const t of o){const{ret:r,data:o}=s.fds[e].fd_read(t.buf_len);if(0!=r)return i.setUint32(n,l,!0),r;if(a.set(o,t.buf),l+=o.length,o.length!=t.buf_len)break}return i.setUint32(n,l,!0),0}return 8},fd_readdir(e,t,r,n,i){const a=new DataView(s.inst.exports.memory.buffer),o=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){let l=0;for(;;){const{ret:f,dirent:d}=s.fds[e].fd_readdir_single(n);if(0!=f)return a.setUint32(i,l,!0),f;if(null==d)break;if(r-l<d.head_length()){l=r;break}const u=new ArrayBuffer(d.head_length());if(d.write_head_bytes(new DataView(u),0),o.set(new Uint8Array(u).slice(0,Math.min(u.byteLength,r-l)),t),t+=d.head_length(),l+=d.head_length(),r-l<d.name_length()){l=r;break}d.write_name_bytes(o,t,r-l),t+=d.name_length(),l+=d.name_length(),n=d.d_next}return a.setUint32(i,l,!0),0}return 8},fd_renumber(e,t){if(null!=s.fds[e]&&null!=s.fds[t]){const r=s.fds[t].fd_close();return 0!=r?r:(s.fds[t]=s.fds[e],s.fds[e]=void 0,0)}return 8},fd_seek(e,t,r,n){const i=new DataView(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const{ret:a,offset:o}=s.fds[e].fd_seek(t,r);return i.setBigInt64(n,o,!0),a}return 8},fd_sync:e=>null!=s.fds[e]?s.fds[e].fd_sync():8,fd_tell(e,t){const r=new DataView(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const{ret:n,offset:i}=s.fds[e].fd_tell();return r.setBigUint64(t,i,!0),n}return 8},fd_write(e,t,r,n){const i=new DataView(s.inst.exports.memory.buffer),a=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const o=x.read_bytes_array(i,t,r);let l=0;for(const t of o){const r=a.slice(t.buf,t.buf+t.buf_len),{ret:o,nwritten:f}=s.fds[e].fd_write(r);if(0!=o)return i.setUint32(n,l,!0),o;if(l+=f,f!=r.byteLength)break}return i.setUint32(n,l,!0),0}return 8},path_create_directory(e,t,r){const n=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const i=new TextDecoder("utf-8").decode(n.slice(t,t+r));return s.fds[e].path_create_directory(i)}return 8},path_filestat_get(e,t,r,n,i){const a=new DataView(s.inst.exports.memory.buffer),o=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const l=new TextDecoder("utf-8").decode(o.slice(r,r+n)),{ret:f,filestat:d}=s.fds[e].path_filestat_get(t,l);return null!=d&&d.write_bytes(a,i),f}return 8},path_filestat_set_times(e,t,r,n,i,a,o){const l=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const f=new TextDecoder("utf-8").decode(l.slice(r,r+n));return s.fds[e].path_filestat_set_times(t,f,i,a,o)}return 8},path_link(e,t,r,n,i,a,o){const l=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]&&null!=s.fds[i]){const f=new TextDecoder("utf-8").decode(l.slice(r,r+n)),d=new TextDecoder("utf-8").decode(l.slice(a,a+o)),{ret:u,inode_obj:c}=s.fds[e].path_lookup(f,t);return null==c?u:s.fds[i].path_link(d,c,!1)}return 8},path_open(e,t,r,n,i,a,o,l,f){const d=new DataView(s.inst.exports.memory.buffer),u=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const c=new TextDecoder("utf-8").decode(u.slice(r,r+n));k.log(c);const{ret:h,fd_obj:_}=s.fds[e].path_open(t,c,i,a,o,l);if(0!=h)return h;s.fds.push(_);const p=s.fds.length-1;return d.setUint32(f,p,!0),0}return 8},path_readlink(e,t,r,n,i,a){const o=new DataView(s.inst.exports.memory.buffer),l=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const f=new TextDecoder("utf-8").decode(l.slice(t,t+r));k.log(f);const{ret:d,data:u}=s.fds[e].path_readlink(f);if(null!=u){const e=(new TextEncoder).encode(u);if(e.length>i)return o.setUint32(a,0,!0),8;l.set(e,n),o.setUint32(a,e.length,!0)}return d}return 8},path_remove_directory(e,t,r){const n=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const i=new TextDecoder("utf-8").decode(n.slice(t,t+r));return s.fds[e].path_remove_directory(i)}return 8},path_rename(e,t,r,n,i,a){const o=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]&&null!=s.fds[n]){const l=new TextDecoder("utf-8").decode(o.slice(t,t+r)),f=new TextDecoder("utf-8").decode(o.slice(i,i+a));let{ret:d,inode_obj:u}=s.fds[e].path_unlink(l);if(null==u)return d;if(d=s.fds[n].path_link(f,u,!0),0!=d&&0!=s.fds[e].path_link(l,u,!0))throw"path_link should always return success when relinking an inode back to the original place";return d}return 8},path_symlink(e,t,r,n,i){const a=new Uint8Array(s.inst.exports.memory.buffer);return null!=s.fds[r]?(new TextDecoder("utf-8").decode(a.slice(e,e+t)),new TextDecoder("utf-8").decode(a.slice(n,n+i)),b):8},path_unlink_file(e,t,r){const n=new Uint8Array(s.inst.exports.memory.buffer);if(null!=s.fds[e]){const i=new TextDecoder("utf-8").decode(n.slice(t,t+r));return s.fds[e].path_unlink_file(i)}return 8},poll_oneoff(e,t,r){throw"async io not supported"},proc_exit(e){throw new v(e)},proc_raise(e){throw"raised signal "+e},sched_yield(){},random_get(e,t){const r=new Uint8Array(s.inst.exports.memory.buffer);for(let n=0;n<t;n++)r[e+n]=256*Math.random()|0},sock_recv(e,t,r){throw"sockets not supported"},sock_send(e,t,r){throw"sockets not supported"},sock_shutdown(e,t){throw"sockets not supported"},sock_accept(e,t){throw"sockets not supported"}}}};class D{fd_allocate(e,t){return b}fd_close(){return 0}fd_fdstat_get(){return{ret:b,fdstat:null}}fd_fdstat_set_flags(e){return b}fd_fdstat_set_rights(e,t){return b}fd_filestat_get(){return{ret:b,filestat:null}}fd_filestat_set_size(e){return b}fd_filestat_set_times(e,t,r){return b}fd_pread(e,t){return{ret:b,data:new Uint8Array}}fd_prestat_get(){return{ret:b,prestat:null}}fd_pwrite(e,t){return{ret:b,nwritten:0}}fd_read(e){return{ret:b,data:new Uint8Array}}fd_readdir_single(e){return{ret:b,dirent:null}}fd_seek(e,t){return{ret:b,offset:0n}}fd_sync(){return 0}fd_tell(){return{ret:b,offset:0n}}fd_write(e){return{ret:b,nwritten:0}}path_create_directory(e){return b}path_filestat_get(e,t){return{ret:b,filestat:null}}path_filestat_set_times(e,t,r,n,s){return b}path_link(e,t,r){return b}path_unlink(e){return{ret:b,inode_obj:null}}path_lookup(e,t){return{ret:b,inode_obj:null}}path_open(e,t,r,n,s,i){return{ret:54,fd_obj:null}}path_readlink(e){return{ret:b,data:null}}path_remove_directory(e){return b}path_rename(e,t,r){return b}path_unlink_file(e){return b}}class B{}class T extends D{fd_allocate(e,t){if(this.file.size>e+t);else{const r=new Uint8Array(Number(e+t));r.set(this.file.data,0),this.file.data=r}return 0}fd_fdstat_get(){return{ret:0,fdstat:new U(4,0)}}fd_filestat_set_size(e){if(this.file.size>e)this.file.data=new Uint8Array(this.file.data.buffer.slice(0,Number(e)));else{const t=new Uint8Array(Number(e));t.set(this.file.data,0),this.file.data=t}return 0}fd_read(e){const t=this.file.data.slice(Number(this.file_pos),Number(this.file_pos+BigInt(e)));return this.file_pos+=BigInt(t.length),{ret:0,data:t}}fd_pread(e,t){return{ret:0,data:this.file.data.slice(Number(t),Number(t+BigInt(e)))}}fd_seek(e,t){let r;switch(t){case 0:r=e;break;case 1:r=this.file_pos+e;break;case 2:r=BigInt(this.file.data.byteLength)+e;break;default:return{ret:28,offset:0n}}return r<0?{ret:28,offset:0n}:(this.file_pos=r,{ret:0,offset:this.file_pos})}fd_tell(){return{ret:0,offset:this.file_pos}}fd_write(e){if(this.file.readonly)return{ret:8,nwritten:0};if(this.file_pos+BigInt(e.byteLength)>this.file.size){const t=this.file.data;this.file.data=new Uint8Array(Number(this.file_pos+BigInt(e.byteLength))),this.file.data.set(t)}return this.file.data.set(e,Number(this.file_pos)),this.file_pos+=BigInt(e.byteLength),{ret:0,nwritten:e.byteLength}}fd_pwrite(e,t){if(this.file.readonly)return{ret:8,nwritten:0};if(t+BigInt(e.byteLength)>this.file.size){const r=this.file.data;this.file.data=new Uint8Array(Number(t+BigInt(e.byteLength))),this.file.data.set(r)}return this.file.data.set(e,Number(t)),{ret:0,nwritten:e.byteLength}}fd_filestat_get(){return{ret:0,filestat:this.file.stat()}}constructor(e){super(),this.file_pos=0n,this.file=e}}class I extends B{path_open(e,t,r){if(this.readonly&&(t&BigInt(64))==BigInt(64))return{ret:63,fd_obj:null};if(!(8&~e)){if(this.readonly)return{ret:63,fd_obj:null};this.data=new Uint8Array([])}const n=new T(this);return 1&r&&n.fd_seek(0n,2),{ret:0,fd_obj:n}}get size(){return BigInt(this.data.byteLength)}stat(){return new j(4,this.size)}constructor(e,t){super(),this.data=new Uint8Array(e),this.readonly=!!t?.readonly}}class E extends D{fd_filestat_get(){return{ret:0,filestat:new j(2,BigInt(0))}}fd_fdstat_get(){const e=new U(2,0);return e.fs_rights_base=BigInt(64),{ret:0,fdstat:e}}fd_write(e){return this.write(e),{ret:0,nwritten:e.byteLength}}static lineBuffered(e){const t=new TextDecoder("utf-8",{fatal:!1});let r="";return new E((n=>{r+=t.decode(n,{stream:!0});const s=r.split("\n");for(const[t,n]of s.entries())t<s.length-1?e(n):r=n}))}constructor(e){super(),this.write=e}}const z=({share:e})=>(0,n.jsx)(a.az,{padded:a.Y7.TB,paddedSmall:!0,children:(0,n.jsxs)(a.so,{alignItems:a.TR.Center,gap:"16px",children:[(0,n.jsx)("hgroup",{children:(0,n.jsx)("h1",{className:h.ef.TitleSmall,children:"Jsonnet Playground"})}),(0,n.jsxs)(u,{children:[(0,n.jsx)(d,{type:"reset",children:"Reset"}),(0,n.jsx)(d,{onClick:e,children:"Share"})]}),(0,n.jsx)(c.D0,{children:(0,n.jsxs)(a.so,{alignItems:a.TR.Center,children:[(0,n.jsx)(c.pd,{type:"checkbox",name:"strout",toggleSwitch:!0}),(0,n.jsx)(c.JU,{children:"String Output"})]})})]})}),L="MAIN",S="main.jsonnet",V=()=>(0,n.jsxs)("svg",{className:"rLrbO7_RJ54qv6Tl","aria-hidden":!0,width:"16",height:"16",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"square",strokeLinejoin:"miter",fill:"none",children:[(0,n.jsx)("polyline",{points:"6 6 18 18"}),(0,n.jsx)("polyline",{points:"18 6 6 18"})]}),N=({id:e,rm:t})=>{const r=e===L,i=(0,s.useCallback)((()=>{t(e)}),[e,t]);return(0,n.jsxs)("div",{children:[(0,n.jsx)(c.D0,{children:(0,n.jsxs)(a.so,{alignItems:a.TR.Center,gap:"8px",children:[(0,n.jsx)(c.JU,{children:"Filename"}),(0,n.jsx)(c.pd,{name:`${e}:name`,value:r?S:void 0,readOnly:r}),!r&&(0,n.jsx)(d,{onClick:i,paddedSmall:!0,"aria-label":"Remove",children:(0,n.jsx)(V,{})})]})}),(0,n.jsx)(c.D0,{children:(0,n.jsxs)(a.so,{dir:a.hM.Col,children:[(0,n.jsx)(c.JU,{children:"Data"}),(0,n.jsx)(c.TM,{name:`${e}:data`,resize:c.$g.Vertical,rows:16,monospace:!0,fullWidth:!0})]})})]})},C=({add:e})=>(0,n.jsx)(a.az,{padded:a.Y7.TB,paddedSmall:!0,children:(0,n.jsx)(u,{children:(0,n.jsx)(d,{onClick:e,children:"Add"})})}),R=e=>"string"==typeof e?e:"",$=e=>{const t=[[S,R(e[`${L}:data`])]];return e.files.forEach((r=>t.push([R(e[`${r}:name`]),R(e[`${r}:data`])]))),{files:Object.fromEntries(t),strout:e.strout}},F=()=>{const e=crypto.randomUUID();return{files:[e],strout:!1,[`${L}:data`]:"local nstd = import 'native:std';\n\nlocal world = import 'dir/world.libsonnet';\n\nassert nstd.log(\n  'These functions are available in the additional native std lib',\n  std.map((function(i) i.key), std.objectKeysValuesAll(nstd)),\n);\n\nassert nstd.log('This is a secret', world.secret);\n\nlocal Person(name='World') = {\n  name: name,\n  welcome: 'Hello ' + name + '!',\n};\n\nlocal person = Person('Kevin');\n\n{\n  people: [Person(), person],\n  secret: world.secrethash,\n  obj: nstd.jsonMergePatch(\n    {\n      foo: {\n        bar: \"baz\",\n      },\n      hello: \"world\",\n    },\n    {\n      foo: {\n        bar: person.name,\n      },\n    },\n  ),\n}\n",[`${e}:name`]:"dir/world.libsonnet",[`${e}:data`]:"local nstd = import 'native:std';\n\n{\n  secret: 'top secret',\n  secrethash: nstd.sha256hex(self.secret),\n}\n"}},M=()=>({stdout:"",stderr:""}),O=()=>{const e=(0,c.mN)(F),t=e.state,r=e.setState;(0,s.useEffect)((()=>{r((e=>{let r;const n=new Set(t.files);for(const t of Object.keys(e)){if("files"===t||"strout"===t)continue;const[s]=t.split(":",1);s===L||n.has(s)||(void 0===r&&(r=Object.assign({},e)),delete r[t])}return r??e}))}),[t,r]);const l=(0,s.useCallback)((()=>{r((e=>{const t=Object.assign({},e);t.files=t.files.slice();const r=crypto.randomUUID();return t.files.push(r),Object.assign(t,{[`${r}:name`]:"",[`${r}:data`]:""}),t}))}),[r]),f=(0,s.useCallback)((e=>{r((t=>{if(e===L)return t;const r=Object.assign({},t),n=r.files.indexOf(e);return n>-1&&(r.files=r.files.toSpliced(n,1)),delete r[`${e}:name`],delete r[`${e}:data`],r}))}),[r]),d=(0,s.useRef)();(0,s.useEffect)((()=>{const e=new AbortController;return d.current=e.signal,()=>{e.abort()}}),[d]);const u=(0,s.useRef)(""),b=(0,_.lq)().navigate,y=(0,s.useCallback)((()=>{(async()=>{const e=await(async e=>{const t=new Blob([e]).stream().pipeThrough(new CompressionStream("gzip")),r=await new Response(t).blob();return await new Promise((e=>{const t=new FileReader;t.onerror=()=>{e({err:t.error??new Error("File reader error")})},t.onload=()=>{if("string"!=typeof t.result)return void e({err:new Error("File reader result is not a string")});const r=t.result.indexOf(",");if(r<0)return void e({err:new Error("File reader result malformed")});const n=t.result.replaceAll(p,(e=>{switch(e){case"+":return"-";case"/":return"_";default:return""}})).slice(r+1);e({value:n})},t.readAsDataURL(r)}))})((r=t,(e=>{const t=e.reduce(((e,t)=>e+t.length),0),r=t+4*e.length,n=3*t+4*e.length;let s=new ArrayBuffer(r),i=0;const a=new TextEncoder;for(let t of e){let e=0;for(;t.length>0;){const r=i+e+4+3*t.length;r>s.byteLength&&(s=g(s,r,n));const o=new Uint8Array(s,i+e+4),{read:l,written:f}=a.encodeInto(t,o);e+=f,t=t.slice(l)}new DataView(s,i).setUint32(0,e,!1),i+=e+4}return s.slice(0,i)})([r.strout?"t":"f",R(r[`${L}:data`])].concat(r.files.flatMap((e=>[R(r[`${e}:name`]),R(r[`${e}:data`])]))))));var r;if((0,o.KA)(e))return void console.error("Failed compressing url code",e.err);if((0,o.gD)(d.current)||(0,o.oH)(d.current))return;const n=await w(e.value);if((0,o.gD)(d.current)||(0,o.oH)(d.current))return;if(n===u.current)return;const s=new URLSearchParams({codev0:e.value});u.current=n,b(`#${s.toString()}`,!0)})()}),[t,d,b]),x=(0,s.useCallback)((()=>{b("",!0)}),[b]),U=(0,_.rd)().url;(0,s.useEffect)((()=>{let e=U.hash;if((0,o.gD)(e))return void(u.current="");e.startsWith("#")&&(e=e.slice(1));const t=new URLSearchParams(e).get("codev0");if((0,o.gD)(t)||""===t)return void(u.current="");const n=new AbortController;return(async()=>{const e=await w(t);if((0,o.oH)(n.signal))return;if(e===u.current)return;const s=await(async e=>{const t=e.replaceAll(m,(e=>{switch(e){case"-":return"+";case"_":return"/";default:return""}})),r=await fetch(`data:application/octet-stream;base64,${t}`),n=r.body?.pipeThrough(new DecompressionStream("gzip"))??new Blob([""]).stream();try{return{value:await new Response(n).arrayBuffer()}}catch(e){return{err:new Error("Failed decoding data",{cause:e})}}})(t);if((0,o.oH)(n.signal))return;if(e===u.current)return;if(u.current=e,(0,o.KA)(s))return void console.error("Failed decompressing url code",s.err);const i=(e=>{const t=(e=>{const t=[],r=new TextDecoder;let n=0;for(;n<e.byteLength;){if(n+4>e.byteLength)return{err:new Error("Malformed buffer string encoding")};const s=new DataView(e,n).getUint32(0,!1);if(n+s+4>e.byteLength)return{err:new Error("Malformed buffer string encoding")};const i=r.decode(new Uint8Array(e,n+4,s));t.push(i),n+=s+4}return{value:t}})(e);if((0,o.KA)(t))return t;if(t.value.length<2)return{err:new Error("File state is malformed")};const r=[],n={files:r,strout:"t"===t.value[0],[`${L}:data`]:t.value[1]},s=t.value.slice(2);if(s.length%2!=0)return{err:new Error("File state is malformed")};for(let e=1;e<s.length;e+=2){const t=s[e-1],i=s[e],a=crypto.randomUUID();r.push(a),n[`${a}:name`]=t??"",n[`${a}:data`]=i??""}return{value:n}})(s.value);(0,o.KA)(i)?console.error("Failed parsing url code",i.err):(console.log("setting files state"),r(i.value))})(),()=>{n.abort()}}),[u,U,r]);const[j,k]=(0,s.useState)(void 0);(0,s.useEffect)((()=>{const e=new AbortController;return(async()=>{const t=await(async e=>{try{return{value:await WebAssembly.compileStreaming(e)}}catch(e){return{err:new Error("Failed compiling wasm module",{cause:e})}}})(fetch(i));(0,o.oH)(e.signal)||((0,o.KA)(t)?console.error("Failed compiling wasm module",t.err):k(t.value))})(),()=>{e.abort()}}),[k]);const v=(0,s.useDeferredValue)(t),[D,B]=(0,s.useState)(M);return(0,s.useEffect)((()=>{if((0,o.gD)(j))return void B(M);const e=new AbortController;return(async()=>{if(B((e=>({stdout:e.stdout,stderr:"Loading..."}))),await(0,o.yy)(250,{signal:e.signal}),(0,o.oH)(e.signal))return;const t=await(async(e,t)=>{const r=new TextEncoder,n=[],s=[],i=(0,o.gD)(t.stdin)?[]:r.encode(t.stdin),a=[new T(new I(i)),E.lineBuffered((e=>{n.push(e)})),E.lineBuffered((e=>{s.push(e)}))],l=new A([],[],a);try{const t=await WebAssembly.instantiate(e,{wasi_snapshot_preview1:l.wasiImport});return t.exports.memory instanceof WebAssembly.Memory?"function"!=typeof t.exports._start?{err:new Error("Wasm module missing memory export")}:(l.start(t),{value:{stdout:n.join("\n"),stderr:s.join("\n")}}):{err:new Error("Wasm module missing memory export")}}catch(e){return{err:new Error("Failed running wasm module",{cause:e})}}})(j,{stdin:JSON.stringify($(v))});(0,o.oH)(e.signal)||((0,o.KA)(t)?B({stdout:"",stderr:`Failed running wasm module: ${t.err.toString()}`}):B(t.value))})(),()=>{e.abort()}}),[B,j,v]),(0,n.jsx)(a.az,{padded:a.Y7.LR,center:!0,children:(0,n.jsxs)(c.lV,{form:e,onReset:x,children:[(0,n.jsx)(z,{share:y}),(0,n.jsxs)(a.so,{gap:"16px",children:[(0,n.jsxs)(a.so,{dir:a.hM.Col,gap:"16px",className:"G_jALWivc15juUoy",children:[(0,n.jsx)(N,{id:L,rm:f}),t.files.map((e=>(0,n.jsx)(N,{id:e,rm:f},e))),(0,n.jsx)(C,{add:l})]}),(0,n.jsxs)(a.so,{dir:a.hM.Col,className:"Q9SofziWBuiCK64h",gap:"8px",children:[(0,n.jsx)("h2",{className:h.ef.TitleMedium,children:"Output"}),(0,n.jsx)("pre",{children:D.stdout}),(0,n.jsx)("h3",{className:h.ef.TitleSmall,children:"Logs"}),(0,n.jsx)("pre",{children:D.stderr})]})]})]})})}}}]);